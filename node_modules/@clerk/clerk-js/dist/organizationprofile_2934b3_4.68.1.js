"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[229],{4095:function(e,i,a){a.d(i,{l:function(){return v}});var t=a(2903),o=a(221),n=a(2784),r=a(8173),l=a(3476),s=a(8690),c=a(5802),d=a(4334),u=a(3736),g=a(1609),m=a(9654);const h=e=>/^\S+@\S+\.\S+$/.test(e),v=e=>{const{navigate:i}=(0,u.useRouter)(),{onSuccess:a,onReset:c=(()=>i("..")),resetButtonLabel:m}=e,{organization:v,invitations:p}=(0,r.useCoreOrganization)({invitations:{pageSize:10,keepPreviousData:!0}}),b=(0,s.useCardState)(),{t:f,locale:P}=(0,d.zJ)(),[y,Z]=(0,n.useState)(!1),S=(0,g.Yp)("emailAddress","",{type:"text",label:(0,d.u1)("formFieldLabel__emailAddresses")}),_=(0,g.Yp)("role","",{label:(0,d.u1)("formFieldLabel__role")});if(!v)return null;const{props:{setError:C,setWarning:x,setSuccess:K,setInfo:T,validatePassword:B,setHasPassedComplexity:R,hasPassedComplexity:D,feedback:w,feedbackType:L,clearFeedback:F,...k}}=S,M=(!!S.value.length||y)&&!!_.value;return(0,t.BX)(s.Form.Root,{onSubmit:e=>{e.preventDefault();const i=new FormData(e.currentTarget);return v.inviteMembers({emailAddresses:S.value.split(","),role:i.get("role")}).then((async()=>{var e;return await(null===(e=null==p?void 0:p.revalidate)||void 0===e?void 0:e.call(p)),a()})).catch((e=>{var i,a,t;if((0,o.kD)(e)&&(e=>{var i,a,t,o;const n=new Set([...null!==(a=null===(i=e.meta)||void 0===i?void 0:i.emailAddresses)&&void 0!==a?a:[],...null!==(o=null===(t=e.meta)||void 0===t?void 0:t.identifiers)&&void 0!==o?o:[]]),r=S.value.split(",");S.setValue(r.filter((e=>!n.has(e))).join(","))})(e.errors[0]),(0,o.kD)(e)&&"duplicate_record"===(null===(a=null===(i=e.errors)||void 0===i?void 0:i[0])||void 0===a?void 0:a.code)){const i=(null===(t=e.errors[0].meta)||void 0===t?void 0:t.emailAddresses)||[];b.setError(f((0,d.u1)("organizationProfile.invitePage.detailsTitle__inviteFailed",{email_addresses:(0,g.z$)(i,P)})))}else(0,g.S3)(e,[],b.setError)}))},children:[(0,t.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,t.BX)(l.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,t.tZ)(l.Text,{localizationKey:(0,d.u1)("formFieldLabel__emailAddresses")}),(0,t.tZ)(l.Text,{localizationKey:(0,d.u1)("formFieldInputPlaceholder__emailAddresses"),colorScheme:"neutral",sx:e=>({fontSize:e.fontSizes.$xs})}),(0,t.tZ)(s.TagInput,{...k,autoFocus:!0,validate:h,sx:{width:"100%"},validateUnsubmittedEmail:e=>Z(h(e))})]})}),(0,t.tZ)(z,{..._}),(0,t.BX)(s.FormButtonContainer,{children:[(0,t.tZ)(s.Form.SubmitButton,{block:!1,isDisabled:!M,localizationKey:(0,d.u1)("organizationProfile.invitePage.formButtonPrimary__continue")}),(0,t.tZ)(s.Form.ResetButton,{localizationKey:m||(0,d.u1)("userProfile.formButtonReset"),block:!1,onClick:c})]})]})},z=e=>{const{options:i,isLoading:a}=(0,c.e)();return(0,t.tZ)(s.Form.ControlRow,{elementId:e.id,children:(0,t.BX)(l.Flex,{direction:"col",gap:2,children:[(0,t.tZ)(l.Text,{localizationKey:e.label}),(0,t.tZ)(m.DQ,{...e.props,roles:i,isDisabled:a,onChange:i=>e.setValue(i),triggerSx:e=>({width:e.sizes.$48,justifyContent:"space-between",display:"flex"}),optionListSx:e=>({minWidth:e.sizes.$48})})]})})}},2848:function(e,i,a){a.d(i,{a:function(){return v},F:function(){return h}});var t=a(2903),o=a(996),n=a(5480),r=a(8173),l=a(3476),s=a(8690),c=a(4804),d=a(3736);const u=({__unstable_manageBillingUrl:e,__unstable_manageBillingMembersLimit:i})=>{const a=(0,d.useRouter)();return(0,t.BX)(l.Flex,{sx:e=>({background:e.colors.$blackAlpha50,padding:e.space.$4,borderRadius:e.radii.$md}),children:[(0,t.tZ)(l.AlertIcon,{variant:"warning",colorScheme:"danger",sx:e=>({marginTop:e.space.$1})}),(0,t.BX)(l.Text,{variant:"regularRegular",sx:e=>({fontWeight:e.fontWeights.$normal,lineHeight:e.lineHeights.$tall}),children:["This organization is limited to ",(0,o.OR)(i)," members.",(0,t.tZ)("br",{}),(0,t.tZ)(l.Link,{variant:"regularRegular",sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,fontWeight:e.fontWeights.$normal}),onClick:()=>a.navigate((0,o.OR)(e)),children:"Upgrade for unlimited members"})]})]})};var g=a(4095),m=a(2609);const h=(0,s.withCardStateProvider)((()=>{const e=(0,l.localizationKeys)("organizationProfile.invitePage.title"),i=(0,l.localizationKeys)("organizationProfile.invitePage.subtitle"),a=(0,s.useCardState)(),c=(0,n.a2)({onNextStep:()=>a.setError(void 0)}),{organization:d}=(0,r.useCoreOrganization)(),{__unstable_manageBillingUrl:h,__unstable_manageBillingMembersLimit:z}=(0,r.useOrganizationProfileContext)();if(!d)return null;const p=!!z&&(0,o.OR)(z)<=d.pendingInvitationsCount+d.membersCount;return(0,t.BX)(n.en,{...c.props,children:[(0,t.BX)(s.ContentPage,{headerTitle:e,headerSubtitle:i,Breadcrumbs:m.G,children:[p&&h&&(0,t.tZ)(u,{__unstable_manageBillingUrl:h,__unstable_manageBillingMembersLimit:z}),(0,t.tZ)(g.l,{onSuccess:c.nextStep})]}),(0,t.tZ)(s.SuccessPage,{title:e,contents:(0,t.tZ)(v,{}),Breadcrumbs:m.G})]})})),v=()=>(0,t.BX)(l.Flex,{direction:"col",center:!0,gap:4,children:[(0,t.tZ)(s.IconCircle,{boxElementDescriptor:l.descriptors.invitationsSentIconBox,iconElementDescriptor:l.descriptors.invitationsSentIcon,icon:c.GT}),(0,t.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.invitePage.successMessage")})]})},9654:function(e,i,a){a.d(i,{DQ:function(){return d},RN:function(){return c},wQ:function(){return l}});var t=a(2903),o=(a(2784),a(3476)),n=a(8690),r=a(5802);const l=e=>{const{headers:i,page:a,onPageChange:r,rows:l,isLoading:c,itemCount:d,itemsPerPage:u,pageCount:g,emptyStateLocalizationKey:m}=e,h=d>0?Math.max(0,(a-1)*u)+1:0,v=Math.min(a*u,d);return(0,t.BX)(o.Col,{gap:4,sx:{width:"100%"},children:[(0,t.tZ)(o.Flex,{sx:{overflowX:"auto"},children:(0,t.BX)(o.Table,{sx:{width:"100%"},children:[(0,t.tZ)(o.Thead,{children:(0,t.tZ)(o.Tr,{children:i.map(((e,i)=>(0,t.tZ)(o.Th,{elementDescriptor:o.descriptors.tableHead,localizationKey:e},i)))})}),(0,t.tZ)(o.Tbody,{children:c?(0,t.tZ)(o.Tr,{children:(0,t.tZ)(o.Td,{colSpan:4,children:(0,t.tZ)(o.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"}})})}):l.length?l:(0,t.tZ)(s,{localizationKey:m},"empty")})]})}),(0,t.tZ)(n.Pagination,{count:g,page:a,onChange:r,siblingCount:1,rowInfo:{allRowsCount:d,startingRow:h,endingRow:v}})]})},s=e=>(0,t.tZ)(o.Tr,{children:(0,t.tZ)(o.Td,{colSpan:4,children:(0,t.tZ)(o.Text,{localizationKey:e.localizationKey,sx:e=>({margin:"auto",display:"block",width:"fit-content",fontSize:e.fontSizes.$xs})})})}),c=e=>(0,t.tZ)(o.Tr,{...e,sx:e=>({":hover":{backgroundColor:e.colors.$blackAlpha50}})}),d=e=>{const{value:i,roles:a,onChange:o,isDisabled:l,triggerSx:s,optionListSx:c}=e,d=!a,u=[{label:"admin",value:"admin"},{label:"basic_member",value:"basic_member"}],{localizeCustomRole:g}=(0,r.q)(),m=[...a||[],...u,{label:"guest_member",value:"guest_member"}].find((e=>e.value===i)),h=(d?u:a).map((e=>({value:e.value,label:g(e.value)||e.label})));return(0,t.BX)(n.Select,{elementId:"role",options:h,value:i,onChange:e=>o(e.value),children:[(0,t.tZ)("input",{name:"role",type:"hidden",value:i}),(0,t.tZ)(n.SelectButton,{sx:s||(e=>({color:e.colors.$colorTextSecondary,backgroundColor:"transparent"})),isDisabled:l,children:g(null==m?void 0:m.value)||(null==m?void 0:m.label)}),(0,t.tZ)(n.SelectOptionList,{sx:c})]})}},6884:function(e,i,a){a.d(i,{D:function(){return r}});var t=a(2903),o=a(8690),n=a(4334);const r=e=>{const{organization:i,...a}=e;return(0,t.tZ)(o.AvatarUploader,{...a,title:(0,n.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,t.tZ)(o.OrganizationAvatar,{size:e=>e.sizes.$11,...i})})}},2609:function(e,i,a){a.d(i,{G:function(){return c},M:function(){return s}});var t=a(2903),o=(a(2784),a(5480)),n=a(8246),r=a(8173),l=a(8690);const s=e=>{const{organization:i}=(0,r.useCoreOrganization)(),{pages:a}=(0,r.useOrganizationProfileContext)(),{isAuthorizedUser:s}=(0,o.DD)((e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"})));return i?(0,t.BX)(l.NavbarContextProvider,{children:[(0,t.tZ)(l.NavBar,{header:(0,t.tZ)(l.OrganizationPreview,{size:"sm",organization:i,sx:e=>({margin:`0 0 ${e.space.$4} ${e.space.$2}`})}),routes:a.routes.filter((e=>e.id!==n.b.MEMBERS||e.id===n.b.MEMBERS&&s)),contentRef:e.contentRef}),e.children]}):null},c=e=>{const{pages:i}=(0,r.useOrganizationProfileContext)();return(0,t.tZ)(l.Breadcrumbs,{...e,pageToRootNavbarRoute:i.pageToRootNavbarRouteMap})}},4821:function(e,i,a){a.r(i),a.d(i,{OrganizationProfile:function(){return ne},OrganizationProfileModal:function(){return re}});var t=a(2903),o=a(2784),n=a(5480),r=a(8173),l=a(3476),s=a(8690),c=a(3736),d=a(2609),u=a(3185),g=a(8246),m=a(1609);const h=()=>{const e=(0,s.useCardState)(),{navigateAfterLeaveOrganization:i}=(0,r.useOrganizationProfileContext)(),{organization:a}=(0,r.useCoreOrganization)(),o=(0,r.useCoreUser)();return a?(0,t.tZ)(z,{organizationName:null==a?void 0:a.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription",{organizationName:null==a?void 0:a.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.successMessage"),onConfirmation:()=>e.runAsync(o.leaveOrganization(a.id)).then(i)}):null},v=()=>{const e=(0,s.useCardState)(),{navigateAfterLeaveOrganization:i}=(0,r.useOrganizationProfileContext)(),{organization:a}=(0,r.useCoreOrganization)();return a?(0,t.tZ)(z,{organizationName:null==a?void 0:a.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.actionDescription",{organizationName:null==a?void 0:a.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.successMessage"),onConfirmation:()=>e.runAsync(a.destroy()).then(i)}):null},z=(0,s.withCardStateProvider)((e=>{const{title:i,messageLine1:a,messageLine2:o,actionDescription:r,organizationName:u,successMessage:g,submitLabel:h,onConfirmation:v,colorScheme:z="danger"}=e,p=(0,n.a2)(),b=(0,s.useCardState)(),{navigate:f}=(0,c.useRouter)(),P=(0,m.Yp)("deleteOrganizationConfirmation","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__confirmDeletion"),isRequired:!0,placeholder:u}),y=!r||P.value===u;return(0,t.BX)(n.en,{...p.props,children:[(0,t.tZ)(s.ContentPage,{headerTitle:i,breadcrumbTitle:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.title"),Breadcrumbs:d.G,children:(0,t.BX)(s.Form.Root,{onSubmit:async()=>{if(y)try{await v().then((()=>p.nextStep()))}catch(e){(0,m.S3)(e,[],b.setError)}},children:[(0,t.tZ)(l.Text,{localizationKey:a}),(0,t.tZ)(l.Text,{localizationKey:o}),(0,t.tZ)(l.Text,{localizationKey:r}),(0,t.tZ)(s.Form.ControlRow,{elementId:P.id,children:(0,t.tZ)(s.Form.Control,{...P.props,required:!0})}),(0,t.BX)(s.FormButtonContainer,{children:[(0,t.tZ)(s.Form.SubmitButton,{block:!1,colorScheme:z,localizationKey:h,isDisabled:!y}),(0,t.tZ)(s.Form.ResetButton,{localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:async()=>{await f("..")}})]})]})}),(0,t.tZ)(s.SuccessPage,{title:i,text:g})]})})),p=(0,s.withCardStateProvider)((()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),i=(0,l.localizationKeys)("organizationProfile.createDomainPage.title"),a=(0,l.localizationKeys)("organizationProfile.createDomainPage.subtitle"),o=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),n=(0,s.useCardState)(),{organization:u}=(0,r.useCoreOrganization)(),{navigate:g}=(0,c.useRouter)(),h=(0,m.Yp)("name","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomain"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomain")});if(!u||!e)return null;const v=""!==h.value.trim();return(0,t.tZ)(s.ContentPage,{headerTitle:i,headerSubtitle:a,breadcrumbTitle:o,Breadcrumbs:d.G,children:(0,t.BX)(s.Form.Root,{onSubmit:e=>(h.setError(void 0),e.preventDefault(),u.createDomain(h.value).then((e=>e.verification&&"verified"===e.verification.status?g(`../domain/${e.id}?mode=select`):g(`../domain/${e.id}/verify`))).catch((e=>{(0,m.S3)(e,[h],n.setError)}))),children:[(0,t.tZ)(s.Form.ControlRow,{elementId:h.id,children:(0,t.tZ)(s.Form.Control,{...h.props,autoFocus:!0,required:!0})}),(0,t.tZ)(s.FormButtons,{isDisabled:!v})]})})}));var b=a(2848),f=a(9813),P=a(5802),y=a(9654);const Z={memberships:{pageSize:10,keepPreviousData:!0}},S=()=>{const e=(0,s.useCardState)(),{organization:i,memberships:a}=(0,r.useCoreOrganization)(Z),{options:o,isLoading:n}=(0,P.e)();if(!i)return null;const c=i=>async()=>e.runAsync((async()=>{var e;const t=await i.destroy();return await(null===(e=null==a?void 0:a.revalidate)||void 0===e?void 0:e.call(a)),t})).catch((i=>(0,m.S3)(i,[],e.setError)));return(0,t.tZ)(y.wQ,{page:(null==a?void 0:a.page)||1,onPageChange:e=>{var i;return null===(i=null==a?void 0:a.fetchPage)||void 0===i?void 0:i.call(a,e)},itemCount:(null==a?void 0:a.count)||0,pageCount:(null==a?void 0:a.pageCount)||0,itemsPerPage:Z.memberships.pageSize,isLoading:(null==a?void 0:a.isLoading)||n,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.detailsTitle__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__joined"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==a?void 0:a.data)||[]).map((i=>{return(0,t.tZ)(_,{membership:i,options:o,onRoleChange:(a=i,i=>e.runAsync((async()=>await a.update({role:i}))).catch((i=>(0,m.S3)(i,[],e.setError)))),onRemove:c(i)},i.id);var a}))})},_=e=>{var i;const{membership:a,onRemove:o,onRoleChange:n,options:c}=e,{localizeCustomRole:d}=(0,P.q)(),u=(0,s.useCardState)(),g=(0,r.useCoreUser)().id===a.publicUserData.userId,m=null===(i=null==c?void 0:c.find((e=>e.value===a.role)))||void 0===i?void 0:i.label;return(0,t.BX)(y.RN,{children:[(0,t.tZ)(l.Td,{children:(0,t.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:a.publicUserData,subtitle:a.publicUserData.identifier,badge:g&&(0,t.tZ)(l.Badge,{textVariant:"extraSmallMedium",localizationKey:(0,l.localizationKeys)("badge__you")})})}),(0,t.tZ)(l.Td,{children:a.createdAt.toLocaleDateString()}),(0,t.tZ)(l.Td,{children:(0,t.tZ)(f.Cc,{permission:"org:sys_memberships:manage",fallback:(0,t.tZ)(l.Text,{sx:e=>({opacity:e.opacity.$inactive}),children:d(a.role)||m}),children:(0,t.tZ)(y.DQ,{isDisabled:u.isLoading||!n,value:a.role,onChange:n,roles:c})})}),(0,t.tZ)(l.Td,{children:(0,t.tZ)(f.Cc,{permission:"org:sys_memberships:manage",children:(0,t.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.menuAction__remove"),isDestructive:!0,onClick:o,isDisabled:g}],elementId:"member"})})})]})};var C=a(996);const x=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{__unstable_manageBillingUrl:i,__unstable_manageBillingLabel:a,__unstable_manageBillingMembersLimit:o}=(0,r.useOrganizationProfileContext)(),n=(0,c.useRouter)();if(!e)return null;const s=(null==e?void 0:e.membersCount)+(null==e?void 0:e.pendingInvitationsCount);return(0,t.BX)(l.Flex,{sx:e=>({background:e.colors.$blackAlpha50,padding:e.space.$4,justifyContent:"space-between",alignItems:"flex-start",borderRadius:e.radii.$md}),children:[(0,t.BX)(l.Col,{children:[(0,t.tZ)(l.Text,{sx:e=>({lineHeight:e.lineHeights.$tall}),children:"Members can be given access to applications."}),(0,C.OR)(o)>0&&(0,t.tZ)(l.Link,{variant:"regularRegular",sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,marginTop:e.space.$1,fontWeight:e.fontWeights.$normal}),onClick:()=>n.navigate((0,C.OR)(i)),children:(0,C.OR)(a)||"Manage billing"})]}),(0,t.tZ)(l.Col,{children:(0,t.BX)(l.Text,{variant:"regularRegular",sx:e=>({fontWeight:e.fontWeights.$normal,lineHeight:e.lineHeights.$tall,color:e.colors.$blackAlpha600}),children:[s," of"," ",o?`${(0,C.OR)(o)} members`:"unlimited"]})})]})};var K=a(4804),T=a(145);const B={manual_invitation:(0,l.localizationKeys)("organizationProfile.badge__manualInvitation"),automatic_invitation:(0,l.localizationKeys)("organizationProfile.badge__automaticInvitation"),automatic_suggestion:(0,l.localizationKeys)("organizationProfile.badge__automaticSuggestion")},R=e=>{const{organizationDomain:i}=e;return i?i.verification&&"verified"===i.verification.status?(0,t.tZ)(l.Badge,{localizationKey:B[i.enrollmentMode],colorScheme:"manual_invitation"===i.enrollmentMode?"neutral":"primary",textVariant:"extraSmallMedium"}):(0,t.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("organizationProfile.badge__unverified"),textVariant:"extraSmallMedium",colorScheme:"danger"}):null},D=(e,i,a)=>(0,C.Xn)((0,C.M)((0,C.ju)(`${e}/${i}/${a||""}`))),w=({redirectSubPath:e,domainId:i})=>{const a=((e,i)=>{const{isAuthorizedUser:a}=(0,n.DD)({permission:"org:sys_domains:manage"}),{navigate:t}=(0,c.useRouter)(),o=[];return a&&(o.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.unverifiedDomain_menuAction__verify"),onClick:()=>t(D(e,i,"verify"))}),o.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.unverifiedDomain_menuAction__remove"),isDestructive:!0,onClick:()=>t(D(e,i,"remove"))})),o})(e,i);return(0,t.tZ)(s.ThreeDotsMenu,{actions:a})},L=(0,n.rh)((e=>{const{verificationStatus:i,enrollmentMode:a,redirectSubPath:d,fallback:u,...g}=e,{organization:m,domains:h}=(0,r.useCoreOrganization)({domains:{infinite:!0,...g}}),{isAuthorizedUser:v}=(0,n.DD)({permission:"org:sys_domains:manage"}),{ref:z}=(0,T.YD)({threshold:0,onChange:e=>{var i;e&&(null===(i=null==h?void 0:h.fetchNext)||void 0===i||i.call(h))}}),{navigate:p}=(0,c.useRouter)(),b=(0,o.useMemo)((()=>(null==h?void 0:h.data)?h.data.filter((e=>{let t=!0,o=!0;return i&&(t=!!e.verification&&e.verification.status===i),a&&(o=e.enrollmentMode===a),t&&o})):[]),[null==h?void 0:h.data]);return m?(0,t.BX)(l.Col,{children:[0===b.length&&!(null==h?void 0:h.isLoading)&&u,b.map((e=>e.verification&&"verified"===e.verification.status&&v?(0,t.tZ)(s.ArrowBlockButton,{variant:"ghost",colorScheme:"neutral",badge:i?void 0:(0,t.tZ)(R,{organizationDomain:e}),sx:e=>({padding:`${e.space.$3} ${e.space.$4}`,minHeight:e.sizes.$10}),onClick:()=>p(D(d,e.id)),children:e.name},e.id):(0,t.tZ)(s.BlockWithTrailingComponent,{sx:e=>({"&:hover":{backgroundColor:e.colors.$blackAlpha50},padding:`${e.space.$none} ${e.space.$4}`,minHeight:e.sizes.$10}),badge:(0,t.tZ)(R,{organizationDomain:e}),trailingComponent:v?(0,t.tZ)(w,{redirectSubPath:d,domainId:e.id}):void 0,children:e.name},e.id))),((null==h?void 0:h.hasNextPage)||(null==h?void 0:h.isFetching))&&(0,t.tZ)(l.Box,{ref:(null==h?void 0:h.isFetching)?void 0:z,sx:[e=>({width:"100%",height:e.space.$10,position:"relative"})],children:(0,t.tZ)(l.Box,{sx:{display:"flex",margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,t.tZ)(l.Spinner,{size:"sm",colorScheme:"primary"})})})]}):null}),{permission:"org:sys_domains:read"}),F={invitations:{pageSize:10,keepPreviousData:!0}},k=()=>{const e=(0,s.useCardState)(),{organization:i,invitations:a}=(0,r.useCoreOrganization)(F),{options:o,isLoading:n}=(0,P.e)();return i?(0,t.tZ)(y.wQ,{page:(null==a?void 0:a.page)||1,onPageChange:(null==a?void 0:a.fetchPage)||(()=>null),itemCount:(null==a?void 0:a.count)||0,pageCount:(null==a?void 0:a.pageCount)||0,itemsPerPage:F.invitations.pageSize,isLoading:(null==a?void 0:a.isLoading)||n,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.tableHeader__invited"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==a?void 0:a.data)||[]).map((i=>{return(0,t.tZ)(M,{options:o,invitation:i,onRevoke:(n=i,async()=>e.runAsync((async()=>{var e;return await n.revoke(),await(null===(e=null==a?void 0:a.revalidate)||void 0===e?void 0:e.call(a)),n})).catch((i=>(0,m.S3)(i,[],e.setError))))},i.id);var n}))}):null},M=e=>{var i;const{invitation:a,onRevoke:o,options:n}=e,{localizeCustomRole:r}=(0,P.q)(),c=null===(i=null==n?void 0:n.find((e=>e.value===a.role)))||void 0===i?void 0:i.label;return(0,t.BX)(y.RN,{children:[(0,t.tZ)(l.Td,{children:(0,t.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:{primaryEmailAddress:{emailAddress:a.emailAddress}}})}),(0,t.tZ)(l.Td,{children:a.createdAt.toLocaleDateString()}),(0,t.tZ)(l.Td,{children:(0,t.tZ)(l.Text,{colorScheme:"neutral",localizationKey:r(a.role)||c})}),(0,t.tZ)(l.Td,{children:(0,t.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.menuAction__revoke"),isDestructive:!0,onClick:o}],elementId:"invitation"})})]})},O=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{navigate:a}=(0,c.useRouter)(),{__unstable_manageBillingUrl:o}=(0,r.useOrganizationProfileContext)(),d=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,t.BX)(l.Col,{gap:8,sx:{width:"100%"},children:[o&&(0,t.tZ)(x,{}),d&&(0,t.tZ)(n.Cc,{permission:"org:sys_domains:manage",children:(0,t.BX)(l.Col,{gap:2,sx:{width:"100%"},children:[(0,t.BX)(s.Header.Root,{children:[(0,t.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerTitle"),textVariant:"largeMedium"}),(0,t.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerSubtitle"),variant:"regularRegular"})]}),(0,t.tZ)(L,{fallback:(0,t.tZ)(n.of,{colorScheme:"primary",textLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.primaryButton"),id:"manageVerifiedDomains",onClick:()=>a("organization-settings/domain")}),redirectSubPath:"organization-settings/domain",verificationStatus:"verified",enrollmentMode:"automatic_invitation"})]})}),(0,t.BX)(l.Flex,{direction:"col",gap:4,sx:{width:"100%"},children:[(0,t.BX)(l.Flex,{justify:"between",align:"center",children:[(0,t.BX)(s.Header.Root,{children:[(0,t.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.manualInvitations.headerTitle"),textVariant:"largeMedium"}),(0,t.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.manualInvitations.headerSubtitle"),variant:"regularRegular"})]}),(0,t.tZ)(s.IconButton,{elementDescriptor:l.descriptors.membersPageInviteButton,"aria-label":"Invite",onClick:()=>a("invite-members"),icon:(0,t.tZ)(l.Icon,{icon:K.av,size:"sm",sx:e=>({marginRight:e.space.$2})}),textVariant:"buttonExtraSmallBold",localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.action__invite")})]}),(0,t.tZ)(k,{})]})]})},X={membershipRequests:{pageSize:10,keepPreviousData:!0}},$=()=>{var e;const i=(0,s.useCardState)(),{organization:a,membershipRequests:o}=(0,r.useCoreOrganization)(X);return a?(0,t.tZ)(y.wQ,{page:(null==o?void 0:o.page)||1,onPageChange:null!==(e=null==o?void 0:o.fetchPage)&&void 0!==e?e:()=>null,itemCount:(null==o?void 0:o.count)||0,pageCount:(null==o?void 0:o.pageCount)||0,itemsPerPage:X.membershipRequests.pageSize,isLoading:null==o?void 0:o.isLoading,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.tableHeader__requested"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==o?void 0:o.data)||[]).map((e=>(0,t.tZ)(I,{request:e,onError:i.setError},e.id)))}):null},I=(0,s.withCardStateProvider)((e=>{const{request:i,onError:a}=e,o=(0,s.useCardState)(),{membership:n,membershipRequests:c}=(0,r.useCoreOrganization)(X);return(0,t.BX)(y.RN,{children:[(0,t.tZ)(l.Td,{children:(0,t.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},showAvatar:!1,user:{primaryEmailAddress:{emailAddress:i.publicUserData.identifier}}})}),(0,t.tZ)(l.Td,{children:i.createdAt.toLocaleDateString()}),(0,t.tZ)(l.Td,{children:(0,t.tZ)(A,{onAccept:()=>{if(n&&c)return o.runAsync((async()=>{await i.accept(),await c.revalidate()}),"accept").catch((e=>(0,m.S3)(e,[],a)))},onReject:()=>{if(n&&c)return o.runAsync((async()=>{await i.reject(),await c.revalidate()}),"reject").catch((e=>(0,m.S3)(e,[],a)))}})})]})})),A=e=>{const i=(0,s.useCardState)();return(0,t.BX)(l.Flex,{gap:2,children:[(0,t.tZ)(l.Button,{textVariant:"buttonExtraSmallBold",variant:"ghost",isLoading:i.isLoading&&"reject"===i.loadingMetadata,isDisabled:i.isLoading&&"reject"!==i.loadingMetadata,onClick:e.onReject,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__reject")}),(0,t.tZ)(l.Button,{textVariant:"buttonExtraSmallBold",variant:"solid",isLoading:i.isLoading&&"accept"===i.loadingMetadata,isDisabled:i.isLoading&&"accept"!==i.loadingMetadata,onClick:e.onAccept,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__approve")})]})},E=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{navigate:a}=(0,c.useRouter)(),{__unstable_manageBillingUrl:o}=(0,r.useOrganizationProfileContext)(),d=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,t.BX)(l.Col,{gap:8,sx:{width:"100%"},children:[o&&(0,t.tZ)(x,{}),d&&(0,t.tZ)(n.Cc,{permission:"org:sys_domains:manage",children:(0,t.BX)(l.Col,{gap:2,sx:{width:"100%"},children:[(0,t.BX)(s.Header.Root,{children:[(0,t.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerTitle"),textVariant:"largeMedium"}),(0,t.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerSubtitle"),variant:"regularRegular"})]}),(0,t.tZ)(L,{fallback:(0,t.tZ)(n.of,{colorScheme:"primary",textLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.primaryButton"),id:"manageVerifiedDomains",onClick:()=>a("organization-settings/domain")}),redirectSubPath:"organization-settings/domain",verificationStatus:"verified",enrollmentMode:"automatic_suggestion"})]})}),(0,t.BX)(l.Flex,{direction:"col",gap:4,sx:{width:"100%"},children:[(0,t.tZ)(l.Flex,{justify:"between",align:"center",children:(0,t.BX)(s.Header.Root,{children:[(0,t.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.requests.headerTitle"),textVariant:"largeMedium"}),(0,t.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.requests.headerSubtitle"),variant:"regularRegular"})]})}),(0,t.tZ)($,{})]})]})},H=(0,s.withCardStateProvider)((()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),a=(0,s.useCardState)(),{isAuthorizedUser:o}=(0,n.DD)({permission:"org:sys_memberships:manage"}),{isAuthorizedUser:c}=(0,n.DD)({permission:"org:sys_memberships:read"}),d=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled,{membershipRequests:u}=(0,r.useCoreOrganization)({membershipRequests:d||void 0}),{__unstable_manageBillingUrl:g}=(0,r.useOrganizationProfileContext)();return null===o?null:(0,t.BX)(l.Col,{elementDescriptor:l.descriptors.page,gap:8,children:[(0,t.tZ)(s.CardAlert,{children:a.error}),(0,t.tZ)(s.NavbarMenuButtonRow,{}),(0,t.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationMembers"),gap:8,children:[(0,t.BX)(s.Header.Root,{children:[(0,t.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__members"),textVariant:"xxlargeMedium"}),(0,t.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerSubtitle__members")})]}),(0,t.BX)(s.Tabs,{children:[(0,t.BX)(s.TabsList,{children:[c&&(0,t.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__members")}),o&&(0,t.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__invitations")}),o&&d&&(0,t.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__requests"),children:(0,t.tZ)(n.dN,{notificationCount:(null==u?void 0:u.count)||0})})]}),(0,t.BX)(s.TabPanels,{children:[c&&(0,t.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,t.BX)(l.Flex,{gap:4,direction:"col",sx:{width:"100%"},children:[o&&g&&(0,t.tZ)(x,{}),(0,t.tZ)(S,{})]})}),o&&(0,t.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,t.tZ)(O,{})}),o&&d&&(0,t.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,t.tZ)(E,{})})]})]})]})]})})),q=()=>(0,t.BX)(l.Col,{elementDescriptor:l.descriptors.page,gap:8,children:[(0,t.tZ)(s.NavbarMenuButtonRow,{}),(0,t.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationSettings"),gap:8,children:[(0,t.BX)(s.Header.Root,{children:[(0,t.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__settings"),textVariant:"xxlargeMedium"}),(0,t.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerSubtitle__settings")})]}),(0,t.tZ)(U,{}),(0,t.tZ)(n.Cc,{permission:"org:sys_domains:read",children:(0,t.tZ)(N,{})}),(0,t.tZ)(V,{})]})]}),U=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{navigate:i}=(0,c.useRouter)();if(!e)return null;const a=(0,t.tZ)(s.OrganizationPreview,{organization:e,size:"lg"});return(0,t.tZ)(s.ProfileSection,{title:(0,l.localizationKeys)("organizationProfile.profilePage.title"),id:"organizationProfile",children:(0,t.tZ)(n.Cc,{permission:"org:sys_profile:manage",fallback:(0,t.tZ)(t.HY,{children:a}),children:(0,t.tZ)(n.of,{onClick:()=>i("profile"),children:a})})})},N=()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),{organization:i}=(0,r.useCoreOrganization)(),{navigate:a}=(0,c.useRouter)();return e&&i&&e.domains.enabled?(0,t.BX)(s.ProfileSection,{title:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),subtitle:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.subtitle"),id:"organizationDomains",children:[(0,t.tZ)(L,{redirectSubPath:"domain"}),(0,t.tZ)(n.Cc,{permission:"org:sys_domains:manage",children:(0,t.tZ)(n.Br,{textLocalizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.primaryButton"),id:"addOrganizationDomain",onClick:()=>a("domain")})})]}):null},V=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{navigate:i}=(0,c.useRouter)(),{isAuthorizedUser:a}=(0,n.DD)({permission:"org:sys_profile:delete"});if(!e)return null;const o=e.adminDeleteEnabled;return(0,t.tZ)(s.ProfileSection,{id:"organizationDanger",title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.title"),sx:e=>({marginBottom:e.space.$4}),children:(0,t.BX)(l.Flex,{gap:4,children:[(0,t.tZ)(s.IconButton,{"aria-label":"Leave organization",icon:(0,t.tZ)(l.Icon,{icon:K.um,size:"sm",sx:e=>({marginRight:e.space.$2})}),variant:"outline",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>i("leave"),localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title")}),a&&o&&(0,t.tZ)(s.IconButton,{"aria-label":"Delete organization",icon:(0,t.tZ)(l.Icon,{icon:K.um,size:"sm",sx:e=>({marginRight:e.space.$2})}),variant:"outline",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>i("delete"),localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title")})]})})};var j=a(6884);const G=(0,s.withCardStateProvider)((()=>{const e=(0,l.localizationKeys)("organizationProfile.profilePage.title"),i=(0,l.localizationKeys)("organizationProfile.profilePage.subtitle"),a=(0,s.useCardState)(),[c,u]=o.useState(!1),{organization:g}=(0,r.useCoreOrganization)(),h=(0,n.a2)({onNextStep:()=>a.setError(void 0)}),v=(0,m.Yp)("name",(null==g?void 0:g.name)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationName")}),z=(0,m.Yp)("slug",(null==g?void 0:g.slug)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationSlug"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationSlug")});if(!g)return null;const p=(g.name!==v.value||g.slug!==z.value||c)&&"error"!==z.feedbackType;return(0,t.BX)(n.en,{...h.props,children:[(0,t.tZ)(s.ContentPage,{headerTitle:e,headerSubtitle:i,Breadcrumbs:d.G,children:(0,t.BX)(s.Form.Root,{onSubmit:async e=>(e.preventDefault(),(p?g.update({name:v.value,slug:z.value}):Promise.resolve()).then(h.nextStep).catch((e=>{(0,m.S3)(e,[v,z],a.setError)}))),children:[(0,t.tZ)(j.D,{organization:g,onAvatarChange:e=>g.setLogo({file:e}).then((()=>{u(!0),a.setIdle()})).catch((e=>(0,m.S3)(e,[],a.setError))),onAvatarRemove:(0,C.QO)(g.imageUrl)?null:()=>{g.setLogo({file:null}).then((()=>{u(!0),a.setIdle()})).catch((e=>(0,m.S3)(e,[],a.setError)))}}),(0,t.tZ)(s.Form.ControlRow,{elementId:v.id,children:(0,t.tZ)(s.Form.Control,{...v.props,autoFocus:!0,required:!0})}),(0,t.tZ)(s.Form.ControlRow,{elementId:z.id,children:(0,t.tZ)(s.Form.Control,{...z.props,onChange:e=>{var i;i=e.target.value,z.setValue(i),z.setError(void 0)},required:!0})}),(0,t.tZ)(s.FormButtons,{isDisabled:!p})]})}),(0,t.tZ)(s.SuccessPage,{title:e,text:(0,l.localizationKeys)("organizationProfile.profilePage.successMessage"),Breadcrumbs:d.G})]})}));var W=a(4334);const Y=()=>{var e,i;const{organizationSettings:a}=(0,r.useEnvironment)(),{organization:s}=(0,r.useCoreOrganization)(),{params:u}=(0,c.useRouter)(),g=o.useRef(),{data:m,status:h}=(0,T.ib)(null==s?void 0:s.getDomain,{domainId:u.id},{onSuccess(e){g.current={...e}}}),{domains:v}=(0,r.useCoreOrganization)({domains:{infinite:!0}});return s&&a?h.isLoading||!m?(0,t.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,t.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(0,t.tZ)(n.hH,{title:(0,W.u1)("organizationProfile.removeDomainPage.title"),messageLine1:(0,W.u1)("organizationProfile.removeDomainPage.messageLine1",{domain:null===(e=g.current)||void 0===e?void 0:e.name}),messageLine2:(0,W.u1)("organizationProfile.removeDomainPage.messageLine2"),successMessage:(0,W.u1)("organizationProfile.removeDomainPage.successMessage",{domain:null===(i=g.current)||void 0===i?void 0:i.name}),deleteResource:()=>null==m?void 0:m.delete().then((()=>{var e;return null===(e=null==v?void 0:v.revalidate)||void 0===e?void 0:e.call(v)})),breadcrumbTitle:(0,W.u1)("organizationProfile.profilePage.domainSection.title"),Breadcrumbs:d.G}):null};var Q=a(869);const J=(e,{infoLabel:i})=>{const a=(null==e?void 0:e.totalPendingInvitations)||0;return 0===((null==e?void 0:e.totalPendingSuggestions)||0)+a?[]:[i,(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInvitationCountLabel",{count:a}),(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutSuggestionCountLabel",{count:a})]},ee=(0,s.withCardStateProvider)((()=>{const e=(0,s.useCardState)(),{organizationSettings:i}=(0,r.useEnvironment)(),{membership:a,organization:o,domains:u}=(0,r.useCoreOrganization)({domains:{infinite:!0}}),{isAuthorizedUser:g}=(0,n.DD)({permission:"org:sys_domains:manage"}),{navigateToFlowStart:h}=(0,T.zk)(),{params:v,navigate:z,queryParams:p}=(0,c.useRouter)(),b=p.mode||"edit",f=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),P="edit"===b,y=(0,m.Yp)("enrollmentMode","",{type:"radio",radioOptions:[...i.domains.enrollmentModes.includes("manual_invitation")?[{value:"manual_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__description")}]:[],...i.domains.enrollmentModes.includes("automatic_invitation")?[{value:"automatic_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__description")}]:[],...i.domains.enrollmentModes.includes("automatic_suggestion")?[{value:"automatic_suggestion",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__description")}]:[]]}),Z=(0,m.Yp)("deleteExistingInvitationsSuggestions","",{label:(0,l.localizationKeys)("formFieldLabel__organizationDomainDeletePending"),type:"checkbox"}),{data:S,status:_}=(0,T.ib)(null==o?void 0:o.getDomain,{domainId:v.id},{onSuccess(e){y.setValue(e.enrollmentMode)}}),C=Z.checked||(null==S?void 0:S.enrollmentMode)!==y.value,x=(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.subtitle",{domain:null==S?void 0:S.name}),B=J(S,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInfoLabel")}),R=J(S,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.calloutInfoLabel")});return o&&i?_.isLoading||!S?(0,t.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,t.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(S.verification&&"verified"===S.verification.status||h(),(0,t.tZ)(s.ContentPage,{headerTitle:S.name,headerSubtitle:P?void 0:x,breadcrumbTitle:f,gap:4,Breadcrumbs:d.G,children:(0,t.tZ)(l.Col,{gap:6,children:(0,t.BX)(s.Tabs,{children:[(0,t.BX)(s.TabsList,{children:[g&&(0,t.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.start.headerTitle__enrollment")}),P&&g&&(0,t.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.start.headerTitle__danger")})]}),(0,t.BX)(s.TabPanels,{children:[g&&(0,t.BX)(s.TabPanel,{sx:{width:"100%"},direction:"col",gap:4,children:[B.length>0&&(0,t.tZ)(n.aX,{icon:K.I$,children:B.map(((e,i)=>(0,t.tZ)(l.Text,{as:"span",sx:[e=>({lineHeight:e.lineHeights.$short,color:"inherit",display:"block"})],localizationKey:e},i)))}),(0,t.tZ)(s.Header.Root,{children:(0,t.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.subtitle"),variant:"regularRegular"})}),(0,t.BX)(s.Form.Root,{onSubmit:async()=>{if(S&&o&&a&&u)try{await S.updateEnrollmentMode({enrollmentMode:y.value,deletePending:Z.checked}),await u.revalidate(),await z("../../")}catch(i){(0,m.S3)(i,[y],e.setError)}},gap:6,children:[(0,t.tZ)(s.Form.ControlRow,{elementId:y.id,children:(0,t.tZ)(s.Form.Control,{...y.props})}),P&&(0,t.tZ)(s.Form.ControlRow,{elementId:Z.id,children:(0,t.tZ)(s.Form.Control,{...Z.props})}),(0,t.tZ)(s.FormButtons,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.formButton__save"),isDisabled:_.isLoading||!S||!C})]})]}),P&&g&&(0,t.BX)(s.TabPanel,{direction:"col",gap:4,sx:{width:"100%"},children:[R.length>0&&(0,t.tZ)(n.aX,{icon:K.I$,children:R.map(((e,i)=>(0,t.tZ)(l.Text,{as:"span",sx:[e=>({lineHeight:e.lineHeights.$short,color:"inherit",display:"block"})],localizationKey:e},i)))}),(0,t.tZ)(l.Col,{sx:e=>({padding:`${e.space.$none} ${e.space.$4}`}),children:(0,t.tZ)(Q.f,{title:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainTitle"),subtitle:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainSubtitle"),actionLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainActionLabel__remove"),colorScheme:"danger",onClick:()=>z(`../../domain/${S.id}/remove`)})})]})]})]})})})):null}));var ie=a(6684);const ae=(0,s.withCardStateProvider)((()=>{var e;const i=(0,s.useCardState)(),{organizationSettings:a}=(0,r.useEnvironment)(),{organization:u}=(0,r.useCoreOrganization)(),{params:g,navigate:h}=(0,c.useRouter)(),[v,z]=o.useState(!1),{data:p,status:b}=(0,T.ib)(null==u?void 0:u.getDomain,{domainId:g.id}),f=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.title"),P=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitle",{domainName:null!==(e=null==p?void 0:p.name)&&void 0!==e?e:""}),y=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),Z=(0,T._m)(),S=(0,m.Yp)("code",""),_=(0,s.useCodeControl)(S),C=(0,n.a2)({onNextStep:()=>i.setError(void 0)}),x=(0,m.Yp)("affiliationEmailAddress","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddress"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomainEmailAddress"),infoText:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddressDescription")}),K=(0,o.useRef)(),B=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitleVerificationCodeScreen",{emailAddress:K.current}),R=async()=>{z(!0),await(0,m._v)(750)},D=async e=>{(0,m.S3)(e,[S],i.setError),Z.setIdle(),await(0,m._v)(750),_.reset()};if(_.onCodeEntryFinished((e=>{Z.setLoading(),S.setError(void 0),((e,i,a)=>{var t;null===(t=null==p?void 0:p.attemptAffiliationVerification)||void 0===t||t.call(p,{code:e}).then((async e=>{var a;if(await i(),"verified"===(null===(a=e.verification)||void 0===a?void 0:a.status))return h(`../../../domain/${e.id}?mode=select`)})).catch((e=>a(e)))})(e,R,D)})),!u||!a)return null;const w=u.name!==x.value,L=`@${null==p?void 0:p.name}`;return b.isLoading||!p?(0,t.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,t.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(0,t.BX)(n.en,{...C.props,children:[(0,t.tZ)(s.ContentPage,{headerTitle:f,breadcrumbTitle:y,headerSubtitle:P,Breadcrumbs:d.G,children:(0,t.BX)(s.Form.Root,{onSubmit:e=>{if(e.preventDefault(),p)return K.current=`${x.value}${L}`,p.prepareAffiliationVerification({affiliationEmailAddress:K.current}).then(C.nextStep).catch((e=>{(0,m.S3)(e,[x],i.setError)}))},children:[(0,t.tZ)(s.Form.ControlRow,{elementId:x.id,children:(0,t.tZ)(s.Form.Control,{...x.props,autoFocus:!0,groupSuffix:`@${p.name}`,required:!0})}),(0,t.tZ)(s.FormButtons,{isDisabled:!w})]})}),(0,t.BX)(s.ContentPage,{headerTitle:f,breadcrumbTitle:y,headerSubtitle:B,Breadcrumbs:d.G,children:[(0,t.tZ)(ie.T,{title:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formTitle"),subtitle:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formSubtitle"),resendButton:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.resendButton"),isLoading:Z.isLoading,success:v,codeControl:_,onResendCodeClicked:()=>{_.reset(),null==p||p.prepareAffiliationVerification({affiliationEmailAddress:x.value}).catch((e=>{(0,m.S3)(e,[x],i.setError)}))}}),(0,t.tZ)(s.FormButtonContainer,{children:(0,t.tZ)(l.Button,{elementDescriptor:l.descriptors.formButtonReset,block:!1,variant:"ghost",textVariant:"buttonExtraSmallBold",type:"reset",isDisabled:Z.isLoading||v,onClick:()=>{S.clearFeedback(),_.reset(),C.prevStep()},localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset")})})]})]})})),te=e=>{var i;const{pages:a}=(0,r.useOrganizationProfileContext)(),o=a.routes[0].id===g.b.MEMBERS,l=a.routes[0].id===g.b.SETTINGS,d=null===(i=a.contents)||void 0===i?void 0:i.map(((e,i)=>{const a=!l&&!o&&0===i;return(0,t.tZ)(c.Route,{index:a,path:a?void 0:e.url,children:(0,t.tZ)(u.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)}));return(0,t.tZ)(s.ProfileCardContent,{contentRef:e.contentRef,children:(0,t.BX)(c.Switch,{children:[d,(0,t.BX)(c.Route,{children:[(0,t.tZ)(c.Route,{path:l?void 0:"organization-settings",children:(0,t.BX)(c.Switch,{children:[(0,t.tZ)(c.Route,{path:"profile",flowStart:!0,children:(0,t.tZ)(n.Cc,{permission:"org:sys_profile:manage",redirectTo:"../",children:(0,t.tZ)(G,{})})}),(0,t.tZ)(c.Route,{path:"domain",flowStart:!0,children:(0,t.BX)(c.Switch,{children:[(0,t.tZ)(c.Route,{path:":id/verify",children:(0,t.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,t.tZ)(ae,{})})}),(0,t.tZ)(c.Route,{path:":id/remove",children:(0,t.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,t.tZ)(Y,{})})}),(0,t.tZ)(c.Route,{path:":id",children:(0,t.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,t.tZ)(ee,{})})}),(0,t.tZ)(c.Route,{index:!0,children:(0,t.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../",children:(0,t.tZ)(p,{})})})]})}),(0,t.tZ)(c.Route,{path:"leave",flowStart:!0,children:(0,t.tZ)(h,{})}),(0,t.tZ)(c.Route,{path:"delete",flowStart:!0,children:(0,t.tZ)(n.Cc,{permission:"org:sys_profile:delete",redirectTo:"../",children:(0,t.tZ)(v,{})})}),(0,t.tZ)(c.Route,{index:!0,children:(0,t.tZ)(q,{})})]})}),(0,t.tZ)(c.Route,{path:o?void 0:"organization-members",children:(0,t.BX)(c.Switch,{children:[(0,t.tZ)(c.Route,{path:"invite-members",flowStart:!0,children:(0,t.tZ)(n.Cc,{permission:"org:sys_memberships:manage",redirectTo:"../",children:(0,t.tZ)(b.F,{})})}),(0,t.tZ)(c.Route,{index:!0,children:(0,t.tZ)(n.Cc,{condition:e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"}),redirectTo:l?"../":"./organization-settings",children:(0,t.tZ)(H,{})})})]})})]})]})})},oe=(0,r.withCoreUserGuard)((()=>{const e=o.useRef(null);return(0,t.tZ)(s.ProfileCard,{sx:{height:"100%"},children:(0,t.tZ)(d.M,{contentRef:e,children:(0,t.tZ)(te,{contentRef:e})})})})),ne=(0,n.Q6)((0,n.pK)((0,s.withCardStateProvider)((e=>{const{organization:i}=(0,r.useCoreOrganization)();return i?(0,t.tZ)(l.Flow.Root,{flow:"organizationProfile",children:(0,t.tZ)(l.Flow.Part,{children:(0,t.tZ)(c.Switch,{children:(0,t.tZ)(c.Route,{children:(0,t.tZ)(oe,{})})})})}):null})),"OrganizationProfile",{mode:"redirect"})),re=e=>{const i={...e,routing:"virtual",componentName:"OrganizationProfile",mode:"modal"};return(0,t.tZ)(c.Route,{path:"organizationProfile",children:(0,t.tZ)(r.ComponentContext.Provider,{value:i,children:(0,t.tZ)("div",{children:(0,t.tZ)(ne,{...i})})})})}},869:function(e,i,a){a.d(i,{f:function(){return r}});var t=a(2903),o=a(3476),n=a(145);const r=e=>{const{title:i,subtitle:a,actionLabel:r,titleLabel:l,onClick:s,...c}=e,d=(0,n._m)(),{t:u}=(0,o.useLocalizations)();return(0,t.BX)(o.Col,{gap:2,children:[(0,t.BX)(o.Col,{gap:1,children:[(0,t.BX)(o.Flex,{gap:2,align:"center",children:[(0,t.tZ)(o.Text,{localizationKey:i,variant:"regularMedium"}),l]}),(0,t.tZ)(o.Text,{localizationKey:a,variant:"smallRegular",colorScheme:"neutral"})]}),r&&(0,t.tZ)(o.Button,{localizationKey:r,loadingText:u(r),colorScheme:"primary",variant:"link",...c,isLoading:d.isLoading,onClick:e=>{var i;d.setLoading(),s&&(null===(i=null==s?void 0:s(e))||void 0===i||i.finally((()=>d.setIdle())))}})]})}}}]);